
>https://blog.csdn.net/qq_36982160/article/details/89258056
## 事务
数据库事务通常包含了一个序列的对数据库的读/写操作（一个单元的一系列SQL语句的集合）。包含有以下两个目的：

1. 为数据库操作序列提供了一个从失败中恢复到正常状态的方法，同时提供了数据库即使在异常状态下仍能保持一致性的方法。（系统错误恢复）

2. 当多个应用程序在并发访问数据库时，可以在这些应用程序之间提供一个隔离方法，以防止彼此的操作互相干扰。（并发数据库访问）
当事务被提交给了数据库管理系统（DataBaseManagerService，DBMS），

则DBMS需要确保该事务中的所有操作都成功完成且其结果被永久保存在数据库中，如果事务中有的操作没有成功完成，则事务中的所有操作都需要回滚，回到事务执行前的状态；同时，该事务对数据库或者其他事务的执行无影响，所有的事务都好像在独立的运行。

## 事务的特性(ACID)

A: atomacity原子性，事务必须是原子工作单位；对于其数据修改，要么全部执行，要么全都不执行。

C：consistency一致性，事务在完成时，必须使所有的数据都保持一致状态

I：isolation隔离性，事务不会查看中间状态的数据。换句话说，一个事务的影响在事务提交前对其他事务不可见。

D：durability持久性，事务完成之后，它对于系统的影响是永久性的。该修改即使出现致命系统故障也将一直保持。

## 数据库的三大范式

1. 属性不可分割
2. 表中要有主键，其他字段都依赖于主键
3. 表中不能有其他表中存在的、存储相同信息的字段，通常实现是在通过外键去建立关联。

>https://www.cnblogs.com/yanggb/p/10849850.html

## 主键、外键、索引

定义主键和外键主要是为了维护关系数据库的完整性:
1.主键是能确定一条记录的唯一标识，比如，一条记录包括身份正号，姓名，年龄。身份证号是唯一能确定你这个人的，其他都可能有重复，所以，身份证号是主键。 
2.外键用于与另一张表的关联。是能确定另一张表记录的字段，用于保持数据的一致性。

例子：关系型数据库中的一条记录中有若干个属性，若其中某一个属性组(注意是组)能唯一标识一条记录，该属性组就可以成为一个主键 
比如 ：
学生表(学号，姓名，性别，班级) 
其中每个学生的学号是唯一的，学号就是一个主键 

课程表(课程编号,课程名,学分) 
其中课程编号是唯一的,课程编号就是一个主键 

成绩表(学号,课程号,成绩) 
成绩表中单一一个属性无法唯一标识一条记录，学号和课程号的组合才可以唯一标识一条记录，所以 学号和课程号的属性组是一个主键 
  
成绩表中的学号不是成绩表的主键，但它和学生表中的学号相对应，并且学生表中的学号是学生表的主键，则称成绩表中的学号是学生表的外键,同理 成绩表中的课程号是课程表的外键.

>https://blog.csdn.net/f45056231p/article/details/81070437

3. 数据库中主键与索引的区别

1:主键是为了标识数据库记录唯一性,不允许记录重复,且键值不能为空,主键也是一个特殊索引.
2:数据表中只允许有一个主键,但是可以有多个索引.
3.使用主键会数据库会自动创建主索引,也可以在非主键上创建索引,方便查询效率.
4:**索引可以提高查询速度,它就相当于字典的目录,可以通过它很快查询到想要的结果,而不需要进行全表扫描**（类似于树？）.
5:主键索引外索引的值可以为空.
6:主键也可以由多个字段组成,组成复合主键,同时主键肯定也是唯一索引.
7:唯一索引则表示该索引值唯一,可以由一个或几个字段组成,一个表可以有多个唯一索引.

## sql查表语句的书写顺序

S(select)...F(from)...W(where)...G(group by)...H(having)...O(order by);

解析顺序：
from where groupby having select orderby

from:要查询，先得到数据的位置--即表的位置
where:没有任何聚合操作，对一行行的数据的数据进行筛选，后面不能接聚合函数
group by:按照后面接的条件进行分组
having:分组后，会有多个组存在，再按having后面的条件筛选
select:按上面的条件查询到要的列的数据
order by:按照查询到的列的数据，进行升序或者降序排列

使用示例：

CREATE TABLE `yfd_interviewer` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(256) NOT NULL DEFAULT '',
  `age` INT(11) NOT NULL,
  `createdTime` BIGINT(20) NOT NULL,
  `updatedTime` BIGINT(20) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

select * from `yfd_interviewer`;
//表名前面加上符号，对语句没有影响
`在英文中是反单引号；一般用在两个地方bash中，数据库中。
（1）用在bash中与$()意义相同
（2）“`”是 MYSQL数据库的分隔符。
　　分隔符的加入可使输入的字符串成为有效的MYSQL分隔标识符。
示例：create table `t a'b`(id INT);
创建一个表名包含空格、单引号等字符串时，需要用` 将表名包起来，才可创建成功，否则是语法错误。
    
Select * From Yfd_Interviewer;
//表名大小写，对语句没有影响

SELECT * FROM yfd_interviewer ORDER BY id WHERE name = 'lilei';
//这一句是不对的，因为ORDER BY不能放在WHERE的前面

UPDATE yfd_interviewer SET age = 20 WHERE id  = 1;

## B树和B+的概念和区别

1. B-树的关键字和记录是放在一起的，叶子结点可以看作外部节点，不包含任何信息；B+树的**非叶子节点中只有关键字和指向下一个节点的索引**，记录只放在叶子节点中。

2. 在B-树中，越靠近根节点的记录查询时间越快，只要找到关键字即可以确定记录的存在；而B+树中每个记录的查询时间基本是一样的，都需要从根节点走到叶子节点，而且在叶子节点中还要再比较关键字。实际应用中B+性能更好。


## mysql底层

mysql下面一个node大概能存放1170个指向，所以只要3层就能存放2000万级别的数据量

mysql索引一般使用B+tree（99%）而不会使用hash->范围查找支持的非常好
hash是因为无法使用范围查找->无法支持范围查找

mysql下面的存储引擎有两个MyISAM, InnoDB
MyISAM索引文件和数据文件 是分离的（非聚集）
  在硬盘中的存储结构分为三个文件：
    .frm数据库的存储结构
    .MYD数据库某个表的数据
    .MYi数据库某个表的索引
InnoDB索引文件和数据文件聚集(支持事务，所以应用非常多)
  在硬盘中存储结构只剩下两个文件：
    .frm数据库的结构文件
    .ibd对应的索引+数据聚集文件
  InnoDB索引实现（聚集）少了一次磁盘IO
    表数据文件本身就是按B+Tree组织的一个索引结构文件
    聚集索引-**叶节点包含了完整的数据记录**
    为什么InnoDB表必须有主键，并且推荐使用整形的自增主键
    为什么非主键索引结构叶子节点存储的是主键值？（一致性和节省存储空间）

    MyISAM索引文件和数据文件是分离的（非聚集的）

