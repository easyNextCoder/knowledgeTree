* 单线程如何处理高并发

* I/O多路复用

I/O多路复用是其中的一种高级I/O模型，英文为I/O multiplexing，multiplexing译为多路复用、多路传输的意思。

作为高性能服务，Redis服务器，同时连接多个连接(Socket)是在正常不过的事情。

此时，如何处理多个连接呢？

方式一：传统的多进程并发模型 ，每进来一个新的I/O流会分配一个新的进程管理。
方式二：I/O多路复用 ，单个线程，通过记录跟踪每个I/O流的状态，来同时管理多个I/O流 。
对I/O多路复用的分词理解：

I/O: 这是一种处理I/O的高级模型。
多路: 多个I/O流，多个Socket连接。
复用：多个Socket连接共用单个线程。复用方式：单个线程，记录跟踪每个I/O流的状态，通过开关控制，每次处理一个I/O流。

* redis为什么那么快？

3.影响 Redis 性能的因素(Redis为什么这么快)

参考章节1和2，可以总结提升Redis性能的主要因素如下：

完全基于内存：Redis是纯内存数据库，绝大部分请求都是纯内存操作。内存响应时间大约为百纳秒级别，每秒可进行几百万级别的操作。
非阻塞多路复用IO：Redis使用epoll作为I/O多路复用技术的实现，通过单线程来处理多个链接请求，减少网络IO的耗时。
事件处理模型：Redis自身的事件处理模型将epoll的连接、读写、关闭都转换为文件事件，进一步减少在网络IO上的耗时。
单线程模型：Redis采用单线程模型，简化了数据结构和算法的实现，避免了线程切换、调度(锁)、竞争产生的消耗。
数据结构与特殊处理：Redis数据结构简单，数据操作也简单，而且还专门针对数据指定了压缩、优化、跳表等特殊处理。
特别的，单线程会有一个问题：对于每个命令的执行时间是有要求的。如果某个命令执行过长，会造成其他命令的阻塞，对于Redis这种高性能的服务来说是致命的，所以Redis是面向快速执行场景的数据库。这一点非常关键。

> https://blog.csdn.net/hanchao5272/java/article/details/99690691

## select、poll、epoll

**I/O多路复用模型是一种理论上的模型**，select、poll和epoll都是这个模型的具体实现。

select是第一个实现 (1983 左右在BSD里面实现的)，它存在很多问题：

会修改传入的参数数组，这个对于一个需要调用很多次的函数，是非常不友好的。
select 只能监视1024个链接。
任何一个I/O流出现了数据，select 仅仅会返回，但是并不会告诉哪个I/O流上有数据，需要自己去遍历查找。
select 不是线程安全的。
poll是14年以后(1997年）一帮人实现的，修复了select的很多问题：

不再修改传入的参数数组。
去掉了select只能监视1024个链接的限制。
epoll是5年以后, 在2002, 大神 Davide Libenzi 实现的，继续修复了select和poll的绝大部分问题：



