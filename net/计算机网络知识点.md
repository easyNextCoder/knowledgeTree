# OSI七层模型

7. 应用层(**Application**)
8. 表示层(Presentation)
9. 会话层(Session)
10. 传输层(**Transport**)
11. 网络层(**NetWork**)
12. 数据链路层(**Data link**)
13. 物理层(Physical)

## 应用层
* 应用层功能
	* 提供网络服务的接口
* 应用层服务（各种协议）
  * 文件传(FTP)
  * 电子邮件(SMTP)
  * Web(HTTP)
  * FTP
  * TELNET
  * RIP
## 表示层
* 表示层功能
	* 数据表示转化
		* 转换为主机独立的编码
	* 加密/解密
	* 压缩/解压缩

## 会话层

## 传输层

* 传输层功能简述：
  
  实现端到端的可靠数据传输
  
* 传输层功能
  * 负责源-目的（端-端） （进程间）完整报文传输
  * 分段与重组
  * SAP寻址
    
    * 确保将完整报文提交给正确进程，如端口号
  * 连接控制
  * **流量控制**
    * 使用流水线机制和**滑动窗口**的方法，提高传输效率
      * 流水线机制
        
        * 比如连续发送三个分组，然后再等待，成倍增加性能（一次发送多少数据，增加了多少倍）
      * 流水线协议：
        * 允许发送方在收到ACK之前连续发送多个分组
          * 更大的序列号范围
          * 发送方和/或接收方需要更大的存储空间以缓存分组
      * 滑动窗口协议
        * 滑动窗口协议：Sliding-window protocol
        * 窗口
          * 允许使用的序列号范围
          * 窗口尺寸为N：最多有N个等待确认的消息
        * 滑动窗口
          
          * 随着协议的运行，窗口在序列号空间内**向前滑动**
      * 滑动窗口协议：GBN(Go-Back-toN超时重新回到N，重发),SR 
          * GBN的发送方有缓存，而GBN的接收方没有缓存，消息包有可能乱序到达接收方，但是如果发送过来的序列号大于已经确认的序列号，**直接丢弃**
            
          * 自动机图：https://www.icourse163.org/learn/HIT-154005?tid=1206679208#/learn/content?type=detail&id=1211458183&cid=1214120332
      
          * 滑动窗口中的三种重传协议
              滑动窗口中断三种协议分别是：（从滑动窗口的观点统一看这三种协议）他们的差别仅在于窗口尺寸的大小不同而已。
      
              * 停等协议
      
                  发送窗口=1，接收窗口=1
      
              * GBN协议
      
                  发送窗口>1，接收窗口=1
      
              * SR协议
      
                  发送窗口>1，接收窗口>1
      
          * GBN协议
      
              GBN协议中，发送方在发完一个数据帧后，连续发送若干个数据帧，即使在连续发送过程中收到了接收方发来的应答帧，也可以继续发送。且发送方在每发送完一个数据帧时都要设置超时定时器。**只要在所设置的超时时间内仍未收到确认帧，就要重发相应的数据帧。如：当发送方发送了N个帧后，若发现该N帧的前一个帧在计时器超时后仍未返回其确认信息，则该帧被判为出错或丢失，此时发送方就不得不重新发送出错帧及其后的N帧**。
      
              接受帧只允许按顺序接受帧。为了减少开销，累计确认允许接收端在连续收到好几个正确的确认帧后，只对最后一个数据帧发确认信息，或者可以在自己有数据要发送时才将对以前正确收到的帧加以捎带确认。这就是说，对某一数据帧的确认就表明该数据帧和这以前所有的数据帧均已正确无误地收到了。
              后退N帧协议的接受窗口为1，可以保证按序接受数据帧。若采用n个比特对帧编号，则其发送窗口的尺寸应满足：1~2(n-1)。若发送窗口的尺寸大于2(n-1)，则会造成接受方无法分辨新帧和旧帧。(具体例子见书)
      
          * SR协议
      
              SR协议是当接收方发现某帧出错后，其后继续送来的正确的帧虽然不能立即递交给接收方的高层，但接收方可收下来，存放在一个缓冲区中，同时要求发送方重新传送出错的那一帧。一旦收到重新传来的帧后，就可以原已存于缓冲区中的其余帧一并按正确的顺序递交高层。显然，SR减少了浪费，但要求接收方有足够大的缓冲区空间。
      
              若采用n比特对帧编号，为了保证接收方向向前移动窗口后，新窗口序号与旧窗口序号没有重叠部分，需要满足条件：接受窗口+发送窗口<=2n。假定仍然采用累计确认的方法，并且接受窗口显然不应超过发送窗口，那么接受窗口尺寸不应超过序号范围的一半<=2(n-1)。
      
              ​    
      
               
      
    * 拥塞控制的四种方法
      * CongWin-拥塞窗口 = LastByteSent-LastByteAcked
        * 动态调整以改变发送速率
        * 反映所感知到的网络拥塞
    
      * 慢启动
        当连接刚刚开始的时候将拥塞窗口呈指数型增长，每个RTT将CongWin翻倍，收到每个ACK进行操作；初始速率很慢，但是快速攀升。
        
      * 加性增，乘性减
    
        （**超过Threshold后**)加性增，(**发生拥塞后**)乘性减（CongWin变成一半）；(逐渐增加发送速率，谨慎探测可用带宽<锯齿行为>，发生loss后将CongWin减半)
      
      * 快速恢复，快速重传 
      
      * Loss事件的处理
        * 收到3个重复ACKs
          * CongWin切到一半
          * 然后线性增长
        * Timeout事件
          * CongWin直接设为1个
          * 然后指数增长
          * 达到threshold后，再线性增长
        * 为什么这两个处理不一样？
          * 还能收到ACK说明网络并不是很拥堵
          * timeout表明网络非常拥塞
  * 差错控制
  * 对话控制
    
    * 建立，维护
  * 同步
    
    * 在数据流中插入“同步点”
  
* 更详细的功能介绍
  * 多路复用/分用
    * 接收端进行多路分用：传输层依据头部信息将收到的Segment交给正确的Socket即不同的进程
  * 发送端进行多路复用
    * 从多个Socket接收数据，为每个块数据封装上头部消息，生成Segment，交给网络层。

* TCP报文格式：
	
	![TCP报文格式](C:\Users\xyk\Desktop\knowledgeTree\计算机网络\TCP报文格式.jpeg)
	
	* 序号：seq序号，占32位，用来标识从TCP源端向目的端发送的字节流，发起方发送数据时对此进行标记。
	* 确认号：ack序号，占32位，只有ACK标志位为1时，确认序号字段才有效，ack = seq+1
	* 标志位：共六个URG,ACK,PSH,RST,SYN,FIN
		* URG:紧急指针有效
		* ACK：确认序号有效
		* PSH：接收方应该尽快将这个报文交给应用层
	* RST：重置连接
		* SYN:发起一个新连接
		* FIN：释放一个连接
	
* 传输层负责可靠的数据传输
	* 什么叫可靠的数据传输？
		* **不错，不丢，不乱**
	* 如何实现数据的可靠传输
		* **检校和**解决**不错**问题
		* **ACK确认机制**和**重传机制**解决**不丢**的问题
		* **序列号**解决**不乱**的问题
		* 另外还有一个定时器解决无限等待问题

## 网络层

* 网络层功能的简述：寻址路由和转发

* 网络层功能
	* 负责**源主机到目的主机**数据分组(packet)交付（分片）
		* 可能穿越多个网络
	* 逻辑寻址
		* 全局唯一逻辑地址，确保数据分组被送达目的主机，如IP地址
	* 路由
		* 路由器（或网关）互连网络，并路由分组至最终目的主机
		* 路径选择
	* 分组转发（从发送主机向接收主机发送数据段，分组后转发到目的主机，目的主机再把信息拼接）
	
* 网络层IP数据报格式
	
	​	![数据报格式](C:\Users\xyk\Desktop\knowledgeTree\计算机网络\IP数据报格式.PNG)
	
	* 版本号字段占4位，：IP协议的版本号  e.g.  4->ip4  6->ip6
	* 首部长度字段占4位：IP分组首部长度
		* 以4字节为单位
		* e.g.->IP首部长度为20（5*4）字节    一般情况下都是20个字节
	* 服务类型（TOS）字段占8位：指示期望获得那种类型的服务
		* 1998年这个字段改名为区分服务
		* 只有在网络提供区分服务(DiffServ)时使用
		* 一般情况下不使用，通常IP分组的该字段(第2字节)的值为00H
	* 总长度字段占16位：IP分组的总字节数（首部+数据）
		* 最大IP分组的总长度：65535B
		* 最小的IP分组首部：20B
		* IP分组可以封装的最大数据：65535-20=65515B
	* 标识：占16位
	* 标志位：占4位
	* 片偏移：占12位（以上三个都与数据报的分片有关）
	* 生存时间（TTL）字段占8位：IP分组在网络中可以通过的路由器数（或跳步数）
		* 路由器转发一次分组，TTL减1
		* 如果TTL=0，路由器则丢弃该IP分组（并向源地址发送一个ICMP报文）
	* 协议字段占8位：指示IP分组封装的是哪个协议的数据包
		* 实现复用/分解
		* e.g.6表示封装的TCP段，17表示封装的UDP数据报，也可以表示是ICMP报文
	* 首部检校和字段占16位：实现对IP分组首部差错检测
		* 计算检校和时，该字段置**全0**
		* 采用反码算术运算求和，和的反码作为首部检校和字段
		* 逐跳计算逐跳检验
	* 源IP地址、目的IP地址字段各占32位：分别标识发送分组的源主机/路由器（网络接口）和接收分组的目的主机/路由器（网络接口）的IP地址
	* 选项字段：占长度可变，范围在1-40B之间：携带安全、源选路径、时间戳和路由记录等内容
		* **实际上很少被使用**
	* 填充字段：占长度可变，范围在0-3B之间：目的是补齐整个首部，符合32位对齐，即保证首部长度是4字节的倍数
	
* 网络层的协议
  * IP协议
    * ICMP协议
  * DHCP协议
  * NAT协议
  * 路由协议
    * RIP协议（路由信息协议）
    * OSPF协议
    * IGRP协议
    * BGP协议
  * RAP协议
  
* IP协议
	* IP编址
		* IP地址
			* （网络号NetID-高比特位）
			* （主机号HostID-低比特位）
		* IP子网
			* IP地址具有相同网络号的设备接口
			* 不跨越路由器可以彼此物理联通的接口
	* 有类IP地址
		* A类地址 <NetID(8位）HostID(24位）>0.0.0.0-127.255.255.255(占所有网路地址的50%) ->0开头
		* B类地址<NetID(16)位 HostID（16位）>128.0.0.0-191.255.255.255（占所有网络地址的25%）->10开头
		* C类地址<NetID(24)位 HostID（8位）>192.0.0.0-223.255.255.255（占所有网络地址的25%）->110开头
		* D类地址<总长32位>224.0.0.0-239.255.255.255（占所有网络地址的25%）->1110开头
		* E类地址<总长32位>240.0.0.0-255.255.255.255（占所有网络地址的25%）->1111开头
	* 特殊IP地址（见外面文件夹的图片）
		* A类地址中的全0地址->在本网范围内表示本机，在路由表中表示默认路由（相当于表示整个Internet网络）可以作为源IP不可作为目的IP
		* A类地址中全1->本网广播地址（路由器不转发）不可以作为源地址，可以作为目的地址
		* 127.后面是非全0或者非全1，->用于本地软件环回测试，可以作为源IP也可以作为目的IP
	* 子网掩码：实现高级大型子网划分为更小的子网（但是会存在HostID为全0  或者是全1的情况下，被浪费了不能分配使用的情况）
	* CIDR（无类域间路由）与路由聚合
		* CIDR：消除传统的A类，B类和C类地址界限，方便子网划分
	
* ICMP协议：互联网控制报文协议
	* 功能：支持主机或路由器
		* 差错(或异常）报告
		* 网络探寻
	* 两类ICMP报文
		* 差错报告报文（5种）
			* 目的不可达
			* 源抑制（Source Quench）
			* 超时/超期
			* 参数问题
			* 重定向
		* 网络探寻报文（2组）
			* 回声请求与应答报文(Reply)
			* 时间戳请求与应答报文
	
* DHCP协议（动态主机配置协议：解决如何获取IP地址）
	* 从服务器动态获取
		* IP地址
		* 子网掩码
		* 默认网关地址
		* DNS服务器与IP地址
	* 即插即用
	* 允许地址重用
	* 支持在用地址续租
	* 支持移动用户加入网络
	* **DHCP协议在应用层实现**
		* 请求报文封装到UDP数据报中
		* IP广播
		* 链路广播
	* **DHCP服务器构造ACK报文**
		* 包括分配给客户的IP地址，子网掩码，默认网关，DNS服务器地址
	
* NAT协议（网络地址转换）

* 路由协议
	* RIP协议：路由信息协议（**是在应用层实现的**）
		* 采用距离向量路由算法-利用跳步数来衡量距离远近
		* 算法简单性能不好
	* OSPF协议：开放最短路径优先
		* 采用链路状态路由算法
			* (利用迪杰斯特拉算法计算路由)
			* LS分组扩散（通告）
			* 每个路由器构造完整的网络（AS)拓扑图
			* 算法复杂但是性能更好
		* OSPF协议的优点：
			* 安全：所有OSPF报文可以被认证（预防恶意入侵）
			* 允许使用多条相同费用的路径（RIP只能选一条）**能够使网络负载更均衡。**
			* 对于每条链路，可以针对不同的TOS设置多个不同的费用度量(能够实现不同类型的数据的分流)
			* 集成单播路由与多播路由
	* IGRP协议：内部网关路由协议
		* 思科的私有协议
	* BGP协议（边界网关协议：将Internet粘合成一个整体的关键）
		* 为每个AS提供了一种手段
			* eBGP:从邻居AS获取子网可达性信息
			* iBGP:向所有AS内部路由器传播子网可达性信息
	
* RAP协议（属于局域网中的协议）RARP协议
	
	* 实现由IP地址到MAC物理地址的转换（是通过一个RAP表实现的）
	
* 网络层功能最简洁的总结

  * 路由协议
    * 路径选择
    * RIP, OSPF, BGP

  * 承接作用的是路由表

  * IP协议
    * 寻址规约(conventions）
    * 数据报（分组）格式
    * 分组处理规约
  * ICMP协议（网络控制报文协议 是TCP/IP的子协议）
    * 差错报告
    * 路由器"信息"
    * 功能：
      * 侦测远端主机是否存在
      * 建立及维护路由资料
      * 重导资料传送路径
      * 资料流量控制
  
* 小结：
	* IP ICMP数据报型协议
	* DHCP 路由协议 （NAP RAP处于网络层和链路层之间的协议又都属于局域网中的技术）都是服务型协议 
## 链路层

* 链路层功能简述：组帧，寻址实现节点到结点之间的传输；同时进行流量控制，差错检测和访问控制。
* 数据链路层功能
	* 负责结点-结点(node-to-node)数据传输
	* 组帧(Framing)（将上层的IP数据报进行组帧发送；也就是对网络层进行分组传输）
	* 链路接入/物理寻址(Physical addressing)
		* 在帧头中增加发送端和/或接收端的物理地址表示数据帧的发送端和/或接收端（使用MAC地址来寻找，不同于IP地址）
	* **流量控制**（连接的两个节点间的流量控制）
		* 避免淹没接收端
	* **差错检测**
		* 检测并重传损坏或丢失帧，并避免重复帧
	* **访问控制**
		* 在任一给定时刻决定哪个设备拥有链路（物理介质）控制使用权。
* 两类链路
	* 点对点链路
		* 拨号接入的**PPP协议**
			* PPP数据帧格式
				* 表示(Flag):定界符(delimiter)开始和结束各有一个定界符
				* 地址(Address):无效（仅仅是一个选项)
				* 控制(Control）：无效；未来可能的多种控制域
				* 协议(Protocol):上层协议(eg:PPP-LCP, IP, IPCP,etc)
				* 信息(info):上层协议分组数据（数据中可能有定界符，如果有则加上另一种类型的定界符1，如果这种定界符1也存在则在定界符1之前加上一个定界符1，当进行解释的时候连续出现两个这种定界符1则抛弃前一个）
				* 检校(check):CRC检校，用于差错检测
		* 以太网交换机之间的点对点链路
	* 广播链路（共享介质）
		* 广播链路的分类
			* 早期的总线以太网
			* HFC的上行链路
			* **802.11**无线局域网
		* 广播链路存在的问题
		  * 单一共享广播信道
		  * 两个或者两个以上结点同时传输：产生干扰
		    * 冲突
		      * ​	结点同时接收到两个或者多个信号->接收失败
		      * 如何解决冲突，采用多路访问控制协议
* MAC协议总结：
	* MAC协议的特点：
	  * 采用分布式算法决定如何共享信道，即结点自身来决定何时可以传输数据
	  * 基于信道本身，通信信道共享协调信息（无外信道帮助）
	* **MAC协议**叫做：（英语：Media Access Control Address）
	* 信道划分MAC协议：时间，频带，码片划分
	  * TDMA, FDMA, CDMA
	  * 特点：信道已经经过划分绝对不会出现冲突
	* 随机访问MAC协议（局域网中非常多见）
	  * ALOHA,S-ALOHA,CSMA
	  * CSMA/CD用于以太网（带有冲突检测的随机访问控制协议）
	  * CSMA/CA应用于802.11无线局域网（无线链路中无法检测数据是否有冲突）
	  * 特点：
	    * 当发送数据的时候就利用这个信道的全部带宽
	    * 信道不划分，允许冲突
	    * 采用冲突“恢复”机制
	* 轮转访问MAC协议
	  * 主节点轮训，令牌传递
	  * 蓝牙，FDDI,令牌环网

## 物理层

* 物理层功能
	* 接口特性
		* 机械特性、电器特性、功能特性、规程特性
	* 比特编码
	* 数据率
	* 比特同步
		* 时钟同步
	* 传输模式
		* 单工(simplex)
		* 半双工(half-duplex)
		* 全双工(full-duplex)

# 其他知识点

## 局域网

* 局域网的简单描述：（属于网络层中的大网中的一个小网络组织）

* ARP协议
* 以太网（统治地位的有限局域网技术）（使用CSMA/CD进行冲突域检测）
	* 特点
		* 便宜、造价低
		* 一直能满足网络速率需求从10k-10G
	* 组成
		* 使用共享介质
		* 存在**冲突域**（两个节点同时发送信息可能发生冲突的一个域叫做冲突域)
		* 一开始是总线形式（但是任意两个节点同时发送的时候会存在冲突），后来使用星型拓扑（中间有交换器节点之间不存在冲突域）
	* 不可靠、无连接的服务（链路层中）
		* 无连接：发送帧的网卡与接收帧的网卡间没有握手过程
		* 不可靠：接收网卡不向发送网卡进行确认。（没有确认机制就没有可靠性）
		* 如何处理差错？由于是在局域网内进行传输所以数据出现差错的几率很小，发现有错误的数据帧直接丢弃，之后依靠高层协议来进行处理。
	* 以太网的MAC协议：采用二进制指数退避算法的CSMA/CD协议（算法作用，当出现冲突只有计算出等待时间然后再次重新尝试发送数据）
	* 可以封装IP数据报或者其他的网络层的数据分组（发送端网卡将IP数据报<或其他网络层协议分组封装到以太网帧中>）
	* 以太网帧的结构
		* 前导码(Preamble)(8B):前7个字节的10101010（同步）,第8个字节的10101011
		* 目的MAC地址、源MAC地址  分别是6个字节 广播地址为48个全1，网卡只接受跟自己MAC地址相符的数据帧，或者是广播的数据帧
		* 类型(Type)(2B):指示帧中封装的是那种高层协议的分组（如：IP数据报，Novell IPC数据报，AppleTalk数据报等）**实现以太网的复用分用**
		* 数据(Data)(46-1500B):指上层协议载荷
		* CRC(4B)：循环冗余检校码
	* **（物理层相关）**许多不同的以太网标准
		* 相同的MAC协议和帧格式
		* 不同速率:2Mbps, 10Mbps,100Mbps，1Gbps,10Gbps
		* 不同的物理介质：比如有铜缆（双绞线链路）也有光纤链路
* PPP协议（点对点链路）
* 802.11无线局域网协议

## 互联网安全
* 解决方案：秘钥分发和公钥认证
* 对称秘钥如何分发？
	* 借助两方都信任的秘钥分发中心（KDC)来分发
* 公钥认证
	* 任何一个要发公开秘钥都要去CA去认证，得到公钥证书。
	* 别人拿到公钥证书之后可以去认证中心进行解密

## 综合OSI和TCP/IP的优点

* 应用层：支持各种网络应用
	* FTP, SMTP, HTTP
* 传输层：进程-进程的数据传输
	* TCP,UDP
* 网络层：源主机到目的主机的数据分组路由与转发
	* IP协议，路由协议
* 链路层：相邻网络元素（主机，交换机，路由器等）的数据传输
	* 以太网(Ethernet),802.11(WiFi),PPP
* 物理层：比特传输

## 交换机和路由器

* 交换机：只有两层链路层和物理层
* 路由器：有三层多了一层网络层


## 传输层的服务
* TCP服务
	* 面向连接：客户机、服务器进程间需要建立连接
	* 可靠的传输
	* 流量控制：发送发不会发送速度过快，超过接收方的处理能力
	* 拥塞控制：当网络负载过重时能够限制发送方的发送速度
	* 不提供时间/延迟保障
	* 不提供最小带宽保障
* UDP服务
	* 无连接
	* 不可靠的数据传输
	* 不提供：
		* 可靠性保障
		* 流量控制
		* 拥塞控制延迟保障
		* 带宽保障

* 二者服务的差别和总结：
	
* UDP
	* 基于Internet IP协议
		* 复用/分用
		* 简单的错误校验
	* Best effort服务，UDP段可能
		* 丢失
		* 非按序到达
	* 无连接
		* UDP发送方和接收方之间不需要握手
		* 每个UDP段的处理独立于其他段 
## 各种类型应用占用的端口

* http占用的端口是80端口
* 邮件发送占用的端口是25端口

## MAC地址

 *（英语：Media Access Control Address）

## http中的返回值的含义

200 正确

300 重定向

400 错误 403禁止访问  404 notfound（客户机出现错误）

500 错误（服务器端出现了错误）

## http1.0/1.1/2.0与https

HTTP1.0/1.1/2.0的区别

一、http 1.0 与 1.1

1.0在网页中的使用是在1996年，而1.1却在才开始应用在广大浏览器的网络请求中。

1.缓存处理，1.0中主要通过请求头中的If-Modified-Since,Expires来做为缓存判断的标准，而在1.1中则引入了更多的缓存控制策略如Enity tag，if-unmodified-since，if-match等更多可控制的缓存头来控制缓存策略。

2.网络链接使用的优化。在1.0中，很多用户请求的只是某个对象的一部分，服务器却将整个用户回传，并且不支持断电传输的功能，导致资源浪费，而在1.1中设置了range头域，它允许只请求资源的某个部分，及返回码为206。

3.错误通知的处理，在1.1中新添加了24个错误状态的响应码如409表示请求资源与资源当前的状态发生冲突，410表示某个资源并永久的删除。

4.在1.1中支持长连接和请求的流水线（pipelining）默认开启了connection:keep-alive，即一次tcp链接中可以处理多个请求，而在1.0中每一个请求就要开启一次tcp链接，十分浪费资源。

二、http2.0比http1.x的优化

1.新的二进制解析格式，http1.x中解析是基于文本的，而文本的表现形式多种多样，要做到健壮性必然要考虑很多东西，而二进制则只包括0和1，基于二进制解析的话方便且健壮。

2.多路复用（multiplexing）连接共享，即每一个requests都是用作链接共享机制的。一个request对应一个id，这样一个连接上有多个request，每个连接的request可以随机的混杂在一起，接收方根据他们的id将他们归属到不同的服务器端里面。即http2中多个请求可以在一个连接上并行执行。

3.header压缩，使用encoder来减少需要传输的header的大小。

> https://www.cnblogs.com/zllovellyo/p/12558741.html


## 自己的总结

* http1.1 与http.0之间区别
	* 增加了更多的**缓存处理策略**
	* 网路链接中的优化，**支持返回部分资源**
	* 错误通知的处理，增加了**更多的错误返回码**
	* 默认开启**持久性连接**,即**一个TCP连接可以处理多个请求**

* http2.0与http1.1之间的区别
	* 新的二进制解析，抛弃了文本解析，更加健壮
	* 连接共享：http2中多个请求在一个连接上并行执行
	* header压缩

* http与https之间的区别
	* http在网络传输的时候是发送的明文，而https在网络传输的时候发送的加密的。
	* https = http+SSL（secure-sockest-layer）
		* https是一种通讯协议，是在http协议传输数据过程中，使用SSL/TSL（非对称加密模式）加密

## 家用的PPPoe协议

又叫做PPP over enthernet就是将PPP协议外层包上以太网协议

## 关于网络知识的常见面试题

* 三次握手
	* 客户端发送SYN=1, seq=x
	* 服务器端接收并发送SYN=1,ACK=1,seq=y,ack=x+1;
	* 客户端接收并发送ACK=1，seq=x+1,ack=y+1
	* 最终建立连接
* 四次挥手
	* 客户端发送FIN=1，seq=u(客户端进入终止等待1)
	* 服务器端接收并发送ACK=1,ack=u+1,seq=v(服务器端进入关闭等待状态)
	* 服务器端发送FIN=1,ack=u+1,seq=w(最后确认状态)
	* 客户端接收并发送ACK=1, ack=w+1;(客户端进入时间等待状态(TIME-WAIT))
	* 客户端经历2*MSL（最长报文段寿命时间后）关闭连接
* 为什么连接是三次握手，关闭的时候却是四次握手？
	* 建立连接的时候是用SYN来同步；关闭连接时server收到了FIN但是可能数据没有发送完
* 为什么TIME_WAIT状态需要经过2MSL（最大报文段生存时间）才能进入close状态
	* 因为四次挥手的最后一步是client端向server端发送ACK，但是有可能发送不到，所以等待server端的重传命令。
* 为什么不能用两次握手进行连接
	* 因为客户端不知道你到底有没有收到我发给你的信息
* 如果已经建立了连接，但是客户端突然出现故障怎么办？
	* 服务器端有一个定时器，计算客户端多久没有发送过来信息了，多次没有发送之后关闭连接。
* tcp  udp主要特点等？

* tcp可靠性的原因？
	* 首先自己知道的第一个：确认机制，其实还有其他更多的机制待查


## IPv4中的保留地址
* 运营商用的内网IP：
	100.64.0.1
* 更多的保留的IP地址：
	https://wangye.org/blog/archives/1079/
* 所有的保留地址
	https://zh.wikipedia.org/wiki/%E4%BF%9D%E7%95%99IP%E5%9C%B0%E5%9D%80

## PPPoE

PPPoE（英语：Point-to-Point Protocol over Ethernet），以太网上的点对点协议，是将点对点协议（PPP）封装在以太网（Ethernet）框架中的一种网络隧道协议。由于协议中集成PPP协议，所以实现出传统以太网不能提供的身份验证、加密以及压缩等功能，也可用于缆线调制解调器（cable modem）和数位用户线路（DSL）等以以太网协议向用户提供接入服务的协议体系。 本质上，它是一个允许在以太网广播域中的两个以太网接口间创建点对点隧道的协议。

* 使用时的缺点
	* 使用Internet前，需先透过PPPoE进行拨接，而非电脑引导后立即上网。
	* 部分ISP会对PPPoE的连线用户采取定时断线，以节省营运成本及IP地址的占用，故对于需长时间挂网的用户较不利。但也有部分ISP为提供用户选择PPPoE可发配非固定IP或固定IP的服务。
	* 当前Windows XP之后的Windows，Mac OS X、Linux等操作系统等皆已内置PPPoE的拨接功能，更早期的操作系统需另行安装PPPoE的拨接程序，如Enternet 300、RAS PPPoE等。
* 在进行拨号的时候必须使用MAC地址进行交流。
> https://zh.wikipedia.org/wiki/PPPoE


